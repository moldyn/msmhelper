
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Markov State Modelling of Protein Dynamics.">
      
      
      
        <link rel="canonical" href="https://moldyn.github.io/msmhelper/reference/">
      
      
        <link rel="prev" href="../faq/">
      
      
        <link rel="next" href="io/">
      
      
      <link rel="icon" href="../icon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>msmhelper - msmhelper</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
  <!-- Load fonts from Google -->
  
  
  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300i,400,400i,700,700i%7CPlayfair+Display:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&display=fallback"
  />
  <style>
    :root {
      --md-text-font: "Source Sans Pro";
      --md-headline-font: "Playfair Display";
      --md-code-font: "Source Code Pro";
    }
  </style>
  

    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#msmhelper" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="msmhelper" class="md-header__button md-logo" aria-label="msmhelper" data-md-component="logo">
      <!-- Logo -->

  <img id="logo_default_mode" src="../logo_light.svg" alt="logo" />
  <img id="logo_slate_mode" src="../logo_dark.svg" alt="logo" />

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            msmhelper
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              msmhelper
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/moldyn/msmhelper" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    moldyn/msmhelper
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href=".." class="md-tabs__link">
          
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../tutorials/" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../faq/" class="md-tabs__link">
        
  
    
  
  FAQ

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  Code Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../contributing/" class="md-tabs__link">
          
  
  Development

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="https://moldyn.uni-freiburg.de/" class="md-tabs__link">
        
  
    
  
  MolDyn Freiburg

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="msmhelper" class="md-nav__button md-logo" aria-label="msmhelper" data-md-component="logo">
      <!-- Logo -->

  <img id="logo_default_mode" src="../logo_light.svg" alt="logo" />
  <img id="logo_slate_mode" src="../logo_dark.svg" alt="logo" />

    </a>
    msmhelper
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/moldyn/msmhelper" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    moldyn/msmhelper
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Home
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmark/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Benchmark
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/theory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Theoretical Background
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/msmhelper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Structure of msmhelper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/msm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Estimation and Validation of MSM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/timescales/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Waiting Times and Pathways
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/hummerszabo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HS-Projection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLI
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Code Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="./" class="md-nav__link md-nav__link--active">
              
  
  <span class="md-ellipsis">
    msmhelper
  </span>
  

            </a>
            
              
              <label class="md-nav__link md-nav__link--active" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            msmhelper
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    io
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="md/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    md
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_1_2" id="__nav_4_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_2">
            <span class="md-nav__icon md-icon"></span>
            md
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="md/comparison/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    comparison
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="md/corrections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    corrections
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="md/timescales/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    timescales
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="msm/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    msm
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_1_3" id="__nav_4_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_3">
            <span class="md-nav__icon md-icon"></span>
            msm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="msm/msm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    msm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="msm/tests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="msm/timescales/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    timescales
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="msm/utils/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    utils
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_1_3_4" id="__nav_4_1_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_3_4">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="msm/utils/linalg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    linalg
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="plot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    plot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="statetraj/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    statetraj
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="utils/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    utils
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_1_6" id="__nav_4_1_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_6">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="utils/datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="utils/filtering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    filtering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="utils/tests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tests
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cli
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maintenance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maintenance
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://moldyn.uni-freiburg.de/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MolDyn Freiburg
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#msmhelper" class="md-nav__link">
    <span class="md-ellipsis">
      msmhelper
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msmhelper--msmhelper" class="md-nav__link">
    <span class="md-ellipsis">
      msmhelper
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msmhelper.LumpedStateTraj" class="md-nav__link">
    <span class="md-ellipsis">
      LumpedStateTraj
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LumpedStateTraj">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#msmhelper.LumpedStateTraj.states" class="md-nav__link">
    <span class="md-ellipsis">
      states
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.LumpedStateTraj.nstates" class="md-nav__link">
    <span class="md-ellipsis">
      nstates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.LumpedStateTraj.microstate_trajs" class="md-nav__link">
    <span class="md-ellipsis">
      microstate_trajs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.LumpedStateTraj.microstate_trajs_flatten" class="md-nav__link">
    <span class="md-ellipsis">
      microstate_trajs_flatten
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.LumpedStateTraj.microstate_index_trajs" class="md-nav__link">
    <span class="md-ellipsis">
      microstate_index_trajs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.LumpedStateTraj.microstate_index_trajs_flatten" class="md-nav__link">
    <span class="md-ellipsis">
      microstate_index_trajs_flatten
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.LumpedStateTraj.trajs" class="md-nav__link">
    <span class="md-ellipsis">
      trajs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.LumpedStateTraj.index_trajs" class="md-nav__link">
    <span class="md-ellipsis">
      index_trajs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.LumpedStateTraj.microstates" class="md-nav__link">
    <span class="md-ellipsis">
      microstates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.LumpedStateTraj.nmicrostates" class="md-nav__link">
    <span class="md-ellipsis">
      nmicrostates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.LumpedStateTraj.state_assignment" class="md-nav__link">
    <span class="md-ellipsis">
      state_assignment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.LumpedStateTraj.estimate_markov_model" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_markov_model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msmhelper.StateTraj" class="md-nav__link">
    <span class="md-ellipsis">
      StateTraj
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StateTraj">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#msmhelper.StateTraj.states" class="md-nav__link">
    <span class="md-ellipsis">
      states
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.StateTraj.nstates" class="md-nav__link">
    <span class="md-ellipsis">
      nstates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.StateTraj.ntrajs" class="md-nav__link">
    <span class="md-ellipsis">
      ntrajs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.StateTraj.nframes" class="md-nav__link">
    <span class="md-ellipsis">
      nframes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.StateTraj.trajs" class="md-nav__link">
    <span class="md-ellipsis">
      trajs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.StateTraj.trajs_flatten" class="md-nav__link">
    <span class="md-ellipsis">
      trajs_flatten
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.StateTraj.index_trajs" class="md-nav__link">
    <span class="md-ellipsis">
      index_trajs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.StateTraj.index_trajs_flatten" class="md-nav__link">
    <span class="md-ellipsis">
      index_trajs_flatten
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.StateTraj.estimate_markov_model" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_markov_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msmhelper.StateTraj.state_to_idx" class="md-nav__link">
    <span class="md-ellipsis">
      state_to_idx
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msmhelper.opentxt" class="md-nav__link">
    <span class="md-ellipsis">
      opentxt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msmhelper.savetxt" class="md-nav__link">
    <span class="md-ellipsis">
      savetxt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msmhelper.opentxt_limits" class="md-nav__link">
    <span class="md-ellipsis">
      opentxt_limits
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msmhelper.openmicrostates" class="md-nav__link">
    <span class="md-ellipsis">
      openmicrostates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msmhelper.open_limits" class="md-nav__link">
    <span class="md-ellipsis">
      open_limits
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msmhelper.rename_by_population" class="md-nav__link">
    <span class="md-ellipsis">
      rename_by_population
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msmhelper.rename_by_index" class="md-nav__link">
    <span class="md-ellipsis">
      rename_by_index
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msmhelper.shift_data" class="md-nav__link">
    <span class="md-ellipsis">
      shift_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msmhelper.unique" class="md-nav__link">
    <span class="md-ellipsis">
      unique
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  

  
                  

  
  


  <h1>msmhelper</h1>

<div class="doc doc-object doc-module">



<a id="msmhelper"></a>
    <div class="doc doc-contents first">

      <h2 id="msmhelper--msmhelper">msmhelper<a class="headerlink" href="#msmhelper--msmhelper" title="Permanent link">&para;</a></h2>
<p>This package is designed for the analysis of discrete time series data from Molecular Dynamics (MD) simulations. It focuses on Markov state modeling (MSM), a powerful technique for analyzing complex systems, and provides a set of functions for constructing and analyzing Markov models, including methods calculating transition probabilities, and fitting models to data. The package is suitable for researchers and engineers who need to analyze large and complex datasets in order to gain insights into the behavior of the underlying dynamics.</p>
<p>The module is structured into the following submodules:</p>
<ul>
<li>
<p><a class="autorefs autorefs-internal" href="io/#msmhelper.io"><strong>io:</strong></a> This submodule contains all methods related to reading data from text files and writing data to text files, including helpful header comments.</p>
</li>
<li>
<p><a class="autorefs autorefs-internal" href="md/#msmhelper.md"><strong>md:</strong></a> This submodule offers techniques for the analysis of state trajectories&mdash;commonly known as Molecular Dynamics (MD)&mdash;without relying on Markov state models. It encompasses functions for determining timescales, recognizing significant events, correcting dynamical anomalies, and evaluating various state discretization methods.  These functions provide a comprehensive solution for analyzing time-series data and understanding the underlying dynamics of complex systems.</p>
</li>
<li>
<p><a class="autorefs autorefs-internal" href="msm/#msmhelper.msm"><strong>msm:</strong></a> This submodule contains methods related to Markov state modeling, a powerful technique for analyzing complex systems. It provides a set of functions for constructing and analyzing Markov models, including methods for calculating transition probabilities and estimating various time scales.</p>
</li>
<li>
<p><a class="autorefs autorefs-internal" href="plot/#msmhelper.plot"><strong>plot:</strong></a> This submodule is dedicated to visualizing results. It offers a collection of functions for generating frequently used figures, such as the CK-test, implied timescales, and waiting times.</p>
</li>
<li>
<p><a class="autorefs autorefs-internal" href="statetraj/#msmhelper.statetraj"><strong>statetraj:</strong></a> This submodule contains the two classes <a class="autorefs autorefs-internal" href="statetraj/#msmhelper.statetraj.StateTraj">StateTraj</a> and <a class="autorefs autorefs-internal" href="statetraj/#msmhelper.statetraj.LumpedStateTraj">LumpedStateTraj</a> which are used to represent the time series and allows for an improved performance.</p>
</li>
<li>
<p><a class="autorefs autorefs-internal" href="utils/#msmhelper.utils"><strong>utils:</strong></a> This submodule provides utility functions that can be used to manipulate and test data, such as filtering and validation methods. The functions in this submodule can be used in conjunction with other parts of the software to perform a variety of tasks, making it an essential part of the package.</p>
</li>
</ul>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="msmhelper.LumpedStateTraj" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">LumpedStateTraj</span><span class="p">(</span><span class="n">macrotrajs</span><span class="p">,</span> <span class="n">microtrajs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#msmhelper.LumpedStateTraj" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="msmhelper.statetraj.StateTraj" href="statetraj/#msmhelper.statetraj.StateTraj">StateTraj</a></code></p>


      <p>Class for using the Hummer-Szabo projection with state trajectories.</p>

      <p>Initialize LumpedStateTraj.</p>
<p>If called with LumpedStateTraj instance, it will be returned instead.
This class is an implementation of the Hummer-Szabo projection<sup id="msmhelper.LumpedStateTraj--fnref:1"><a class="footnote-ref" href="#msmhelper.LumpedStateTraj--fn:1">1</a></sup>.</p>
<div class="footnote">
<hr />
<ol>
<li id="msmhelper.LumpedStateTraj--fn:1">
<p>Hummer and Szabo, <strong>Optimal Dimensionality Reduction of
  Multistate Kinetic and Markov-State Models</strong>, <em>J. Phys. Chem. B</em>,
  119 (29), 9029-9037 (2015),
  doi: <a href="https://doi.org/10.1021/jp508375q">10.1021/jp508375q</a>&#160;<a class="footnote-backref" href="#msmhelper.LumpedStateTraj--fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>macrotrajs</code></b>
              (<code>list or ndarray or list of ndarray</code>)
          –
          <div class="doc-md-description">
            <p>Lumped state trajectory/trajectories. The states need to be
integers and all states needs to correspond to union of
microstates.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>microtrajs</code></b>
              (<code>list or ndarray or list of ndarray</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>State trajectory/trajectories. EaThe states should start from zero
and need to be integers.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>positive</code></b>
              (<code>bool</code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code> <span class="arithmatex">\(T_ij\ge0\)</span> will be enforced, else small negative values
are possible.</p>
          </div>
        </li>
    </ul>

                  <details class="quote">
                    <summary>Source code in <code>src/msmhelper/statetraj.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">macrotrajs</span><span class="p">,</span> <span class="n">microtrajs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initialize LumpedStateTraj.</span>

<span class="sd">    If called with LumpedStateTraj instance, it will be returned instead.</span>
<span class="sd">    This class is an implementation of the Hummer-Szabo projection[^1].</span>

<span class="sd">    [^1]: Hummer and Szabo, **Optimal Dimensionality Reduction of</span>
<span class="sd">          Multistate Kinetic and Markov-State Models**, *J. Phys. Chem. B*,</span>
<span class="sd">          119 (29), 9029-9037 (2015),</span>
<span class="sd">          doi: [10.1021/jp508375q](https://doi.org/10.1021/jp508375q)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    macrotrajs : list or ndarray or list of ndarray</span>
<span class="sd">        Lumped state trajectory/trajectories. The states need to be</span>
<span class="sd">        integers and all states needs to correspond to union of</span>
<span class="sd">        microstates.</span>
<span class="sd">    microtrajs : list or ndarray or list of ndarray</span>
<span class="sd">        State trajectory/trajectories. EaThe states should start from zero</span>
<span class="sd">        and need to be integers.</span>
<span class="sd">    positive : bool</span>
<span class="sd">        If `True` $T_ij\ge0$ will be enforced, else small negative values</span>
<span class="sd">        are possible.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">macrotrajs</span><span class="p">,</span> <span class="n">LumpedStateTraj</span><span class="p">):</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">microtrajs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s1">&#39;microtrajs may only be None when macrotrajs is of type &#39;</span> <span class="o">+</span>
            <span class="s1">&#39;LumpedStateTraj.&#39;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">positive</span> <span class="o">=</span> <span class="n">positive</span>

    <span class="c1"># parse macrotraj</span>
    <span class="n">macrotrajs</span> <span class="o">=</span> <span class="n">mh</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">format_state_traj</span><span class="p">(</span><span class="n">macrotrajs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_macrostates</span> <span class="o">=</span> <span class="n">mh</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">macrotrajs</span><span class="p">)</span>

    <span class="c1"># init microstate trajectories</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">microtrajs</span><span class="p">)</span>

    <span class="c1"># cache flattened trajectories to speed up code for many states</span>
    <span class="n">macrotrajs_flatten</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">macrotrajs</span><span class="p">)</span>
    <span class="n">microtrajs_flatten</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">microstate_trajs_flatten</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_state_assignment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nmicrostates</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">microstate</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">microstates</span><span class="p">):</span>
        <span class="n">idx_first</span> <span class="o">=</span> <span class="n">mh</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">find_first</span><span class="p">(</span><span class="n">microstate</span><span class="p">,</span> <span class="n">microtrajs_flatten</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_state_assignment</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">macrotrajs_flatten</span><span class="p">[</span><span class="n">idx_first</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.LumpedStateTraj.states" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">states</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.LumpedStateTraj.states" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return active set of macrostates.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>states</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Numpy array holding active set of states.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.LumpedStateTraj.nstates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nstates</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.LumpedStateTraj.nstates" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return number of macrostates.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>nstates</code></b> (              <code>int</code>
)          –
          <div class="doc-md-description">
            <p>Number of states.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.LumpedStateTraj.microstate_trajs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">microstate_trajs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.LumpedStateTraj.microstate_trajs" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return microstate trajectory.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>trajs</code></b> (              <code>list of ndarrays</code>
)          –
          <div class="doc-md-description">
            <p>List of ndarrays holding the input data.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.LumpedStateTraj.microstate_trajs_flatten" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">microstate_trajs_flatten</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.LumpedStateTraj.microstate_trajs_flatten" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return flattened state trajectory.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>trajs</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>1D ndarrays representation of state trajectories.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.LumpedStateTraj.microstate_index_trajs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">microstate_index_trajs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.LumpedStateTraj.microstate_index_trajs" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return microstate index trajectory.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>trajs</code></b> (              <code>list of ndarrays</code>
)          –
          <div class="doc-md-description">
            <p>List of ndarrays holding the microstate index trajectory.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.LumpedStateTraj.microstate_index_trajs_flatten" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">microstate_index_trajs_flatten</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.LumpedStateTraj.microstate_index_trajs_flatten" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return flattened microstate index trajectory.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>trajs</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>1D ndarrays representation of microstate index trajectories.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.LumpedStateTraj.trajs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">trajs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.LumpedStateTraj.trajs" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return macrostate trajectory.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>trajs</code></b> (              <code>list of ndarrays</code>
)          –
          <div class="doc-md-description">
            <p>List of ndarrays holding the input macrostate data.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.LumpedStateTraj.index_trajs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">index_trajs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.LumpedStateTraj.index_trajs" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return index trajectory.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>trajs</code></b> (              <code>list of ndarrays</code>
)          –
          <div class="doc-md-description">
            <p>List of ndarrays holding the input data.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.LumpedStateTraj.microstates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">microstates</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.LumpedStateTraj.microstates" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return active set of microstates.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>states</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Numpy array holding active set of states.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.LumpedStateTraj.nmicrostates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nmicrostates</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.LumpedStateTraj.nmicrostates" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return number of active set of states.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>states</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Numpy array holding active set of states.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.LumpedStateTraj.state_assignment" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">state_assignment</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.LumpedStateTraj.state_assignment" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return micro to macrostate assignment vector.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>state_assignment</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Micro to macrostate assignment vector.</p>
          </div>
        </li>
    </ul>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="msmhelper.LumpedStateTraj.estimate_markov_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">estimate_markov_model</span><span class="p">(</span><span class="n">lagtime</span><span class="p">)</span></code>

<a href="#msmhelper.LumpedStateTraj.estimate_markov_model" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Estimates Markov State Model.</p>
<p>This method estimates the microstate MSM based on the transition count
matrix, followed by Szabo-Hummer projection<sup id="msmhelper.LumpedStateTraj.estimate_markov_model--fnref:1"><a class="footnote-ref" href="#msmhelper.LumpedStateTraj.estimate_markov_model--fn:1">1</a></sup> formalism to
macrostates.</p>
<div class="footnote">
<hr />
<ol>
<li id="msmhelper.LumpedStateTraj.estimate_markov_model--fn:1">
<p>Hummer and Szabo, <strong>Optimal Dimensionality Reduction of
  Multistate Kinetic and Markov-State Models</strong>, <em>J. Phys. Chem. B</em>,
  119 (29), 9029-9037 (2015),
  doi: <a href="https://doi.org/10.1021/jp508375q">10.1021/jp508375q</a>&#160;<a class="footnote-backref" href="#msmhelper.LumpedStateTraj.estimate_markov_model--fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>lagtime</code></b>
              (<code>int</code>)
          –
          <div class="doc-md-description">
            <p>Lag time for estimating the markov model given in [frames].</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>T</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Transition probability matrix <span class="arithmatex">\(T_{ij}\)</span>, containing the transition
probability transition from state <span class="arithmatex">\(i\to j\)</span>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>states</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Array holding states corresponding to the columns of <span class="arithmatex">\(T_{ij}\)</span>.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>src/msmhelper/statetraj.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">estimate_markov_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lagtime</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Estimates Markov State Model.</span>

<span class="sd">    This method estimates the microstate MSM based on the transition count</span>
<span class="sd">    matrix, followed by Szabo-Hummer projection[^1] formalism to</span>
<span class="sd">    macrostates.</span>

<span class="sd">    [^1]: Hummer and Szabo, **Optimal Dimensionality Reduction of</span>
<span class="sd">          Multistate Kinetic and Markov-State Models**, *J. Phys. Chem. B*,</span>
<span class="sd">          119 (29), 9029-9037 (2015),</span>
<span class="sd">          doi: [10.1021/jp508375q](https://doi.org/10.1021/jp508375q)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lagtime : int</span>
<span class="sd">        Lag time for estimating the markov model given in [frames].</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    T : ndarray</span>
<span class="sd">        Transition probability matrix $T_{ij}$, containing the transition</span>
<span class="sd">        probability transition from state $i\to j$.</span>
<span class="sd">    states : ndarray</span>
<span class="sd">        Array holding states corresponding to the columns of $T_{ij}$.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># in the following corresponds &#39;i&#39; to micro and &#39;a&#39; to macro</span>
    <span class="n">msm_i</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mh</span><span class="o">.</span><span class="n">msm</span><span class="o">.</span><span class="n">msm</span><span class="o">.</span><span class="n">_estimate_markov_model</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">microstate_index_trajs</span><span class="p">,</span>
        <span class="n">lagtime</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nmicrostates</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">microstates</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">mh</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">tests</span><span class="o">.</span><span class="n">is_ergodic</span><span class="p">(</span><span class="n">msm_i</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;tmat needs to be ergodic transition matrix.&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_estimate_markov_model</span><span class="p">(</span><span class="n">msm_i</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="msmhelper.StateTraj" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">StateTraj</span><span class="p">(</span><span class="n">trajs</span><span class="p">)</span></code>

<a href="#msmhelper.StateTraj" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


      <p>Class for handling discrete state trajectories.</p>

      <p>Initialize StateTraj and convert to index trajectories.</p>
<p>If called with StateTraj instance, it will be returned instead.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>trajs</code></b>
              (<code>list or ndarray or list of ndarray</code>)
          –
          <div class="doc-md-description">
            <p>State trajectory/trajectories. The states need to be integers.</p>
          </div>
        </li>
    </ul>

                  <details class="quote">
                    <summary>Source code in <code>src/msmhelper/statetraj.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trajs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize StateTraj and convert to index trajectories.</span>

<span class="sd">    If called with StateTraj instance, it will be returned instead.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    trajs : list or ndarray or list of ndarray</span>
<span class="sd">        State trajectory/trajectories. The states need to be integers.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trajs</span><span class="p">,</span> <span class="n">StateTraj</span><span class="p">):</span>
        <span class="k">return</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_trajs</span> <span class="o">=</span> <span class="n">mh</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">format_state_traj</span><span class="p">(</span><span class="n">trajs</span><span class="p">)</span>

    <span class="c1"># get number of states</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_states</span> <span class="o">=</span> <span class="n">mh</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_trajs</span><span class="p">)</span>

    <span class="c1"># enforce true copy of trajs</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_states</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nstates</span><span class="p">)):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_trajs</span> <span class="o">=</span> <span class="p">[</span><span class="n">traj</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">traj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trajs</span><span class="p">]</span>
    <span class="c1"># shift to indices</span>
    <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_states</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nstates</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_states</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nstates</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_trajs</span> <span class="o">=</span> <span class="p">[</span><span class="n">traj</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">traj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trajs</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># not np.array_equal(self._states, np.arange(self.nstates)):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_trajs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_states</span> <span class="o">=</span> <span class="n">mh</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">rename_by_index</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_trajs</span><span class="p">,</span>
            <span class="n">return_permutation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.StateTraj.states" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">states</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.StateTraj.states" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return active set of states.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>states</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Numpy array holding active set of states.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.StateTraj.nstates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nstates</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.StateTraj.nstates" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return number of states.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>nstates</code></b> (              <code>int</code>
)          –
          <div class="doc-md-description">
            <p>Number of states.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.StateTraj.ntrajs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ntrajs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.StateTraj.ntrajs" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return number of trajectories.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ntrajs</code></b> (              <code>int</code>
)          –
          <div class="doc-md-description">
            <p>Number of trajectories.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.StateTraj.nframes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nframes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.StateTraj.nframes" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return cumulative length of all trajectories.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>nframes</code></b> (              <code>int</code>
)          –
          <div class="doc-md-description">
            <p>Number of frames of all trajectories.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.StateTraj.trajs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">trajs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.StateTraj.trajs" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return state trajectory.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>trajs</code></b> (              <code>list of ndarrays</code>
)          –
          <div class="doc-md-description">
            <p>List of ndarrays holding the input data.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.StateTraj.trajs_flatten" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">trajs_flatten</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.StateTraj.trajs_flatten" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return flattened state trajectory.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>trajs</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>1D ndarray representation of state trajectories.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.StateTraj.index_trajs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">index_trajs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.StateTraj.index_trajs" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return index trajectory.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>trajs</code></b> (              <code>list of ndarrays</code>
)          –
          <div class="doc-md-description">
            <p>List of ndarrays holding the input data.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="msmhelper.StateTraj.index_trajs_flatten" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">index_trajs_flatten</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#msmhelper.StateTraj.index_trajs_flatten" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Return flattened index trajectory.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>trajs</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>1D ndarray representation of index trajectories.</p>
          </div>
        </li>
    </ul>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="msmhelper.StateTraj.estimate_markov_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">estimate_markov_model</span><span class="p">(</span><span class="n">lagtime</span><span class="p">)</span></code>

<a href="#msmhelper.StateTraj.estimate_markov_model" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Estimates Markov State Model.</p>
<p>This method estimates the MSM based on the transition count matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>lagtime</code></b>
              (<code>int</code>)
          –
          <div class="doc-md-description">
            <p>Lag time for estimating the markov model given in [frames].</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>T</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Transition probability matrix <span class="arithmatex">\(T_{ij}\)</span>, containing the transition
probability transition from state <span class="arithmatex">\(i        o j\)</span>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>states</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Array holding states corresponding to the columns of <span class="arithmatex">\(T_{ij}\)</span>.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>src/msmhelper/statetraj.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">estimate_markov_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lagtime</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Estimates Markov State Model.</span>

<span class="sd">    This method estimates the MSM based on the transition count matrix.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lagtime : int</span>
<span class="sd">        Lag time for estimating the markov model given in [frames].</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    T : ndarray</span>
<span class="sd">        Transition probability matrix $T_{ij}$, containing the transition</span>
<span class="sd">        probability transition from state $i\to j$.</span>
<span class="sd">    states : ndarray</span>
<span class="sd">        Array holding states corresponding to the columns of $T_{ij}$.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">mh</span><span class="o">.</span><span class="n">msm</span><span class="o">.</span><span class="n">msm</span><span class="o">.</span><span class="n">_estimate_markov_model</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_trajs</span><span class="p">,</span>
        <span class="n">lagtime</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nstates</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="msmhelper.StateTraj.state_to_idx" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">state_to_idx</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></code>

<a href="#msmhelper.StateTraj.state_to_idx" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Get idx corresponding to state.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>state</code></b>
              (<code>int</code>)
          –
          <div class="doc-md-description">
            <p>State to get idx of.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>idx</code></b> (              <code>int</code>
)          –
          <div class="doc-md-description">
            <p>Idx corresponding to state.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>src/msmhelper/statetraj.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">state_to_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get idx corresponding to state.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    state : int</span>
<span class="sd">        State to get idx of.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    idx : int</span>
<span class="sd">        Idx corresponding to state.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span> <span class="o">==</span> <span class="n">state</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">idx</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s1">&#39;State &quot;</span><span class="si">{state}</span><span class="s1">&quot; does not exists in trajectory.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="msmhelper.opentxt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">opentxt</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#msmhelper.opentxt" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

      <p>Open a text file.</p>
<p>This method can load an nxm array of floats from an ascii file. It uses
either pandas read_csv for a single comment or as fallback the slower
<a class="autorefs autorefs-external" href="https://numpy.org/doc/stable/reference/generated/numpy.loadtxt.html#numpy.loadtxt">np.loadtxt</a> for multiple comments.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In contrast to pandas the order of usecols will be used. So if
using <code>data = opentxt(..., uscols=[1, 0])</code> you access the first column
by <code>data[:, 0]</code> and the second one by <code>data[:, 1]</code>.</p>
</div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>file_name</code></b>
              (<code>string</code>)
          –
          <div class="doc-md-description">
            <p>Name of file to be opened.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>comment</code></b>
              (<code>str or array of str</code>, default:
                  <code>&#39;#&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Characters with which a comment starts.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>nrows</code></b>
              (<code>int</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>The maximum number of lines to be read</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>usecols</code></b>
              (<code>int - array</code>)
          –
          <div class="doc-md-description">
            <p>Columns to be read from the file (zero indexed).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>skiprows</code></b>
              (<code>int</code>)
          –
          <div class="doc-md-description">
            <p>The number of leading rows which will be skipped.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>dtype</code></b>
              (<code>data - type</code>)
          –
          <div class="doc-md-description">
            <p>Data-type of the resulting array. Default: float.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>array</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Data read from the text file.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>src/msmhelper/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">opentxt</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Open a text file.</span>

<span class="sd">    This method can load an nxm array of floats from an ascii file. It uses</span>
<span class="sd">    either pandas read_csv for a single comment or as fallback the slower</span>
<span class="sd">    [np.loadtxt][numpy.loadtxt] for multiple comments.</span>

<span class="sd">    !!! warning</span>
<span class="sd">        In contrast to pandas the order of usecols will be used. So if</span>
<span class="sd">        using `data = opentxt(..., uscols=[1, 0])` you access the first column</span>
<span class="sd">        by `data[:, 0]` and the second one by `data[:, 1]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file_name : string</span>
<span class="sd">        Name of file to be opened.</span>
<span class="sd">    comment : str or array of str, optional</span>
<span class="sd">        Characters with which a comment starts.</span>
<span class="sd">    nrows : int, optional</span>
<span class="sd">        The maximum number of lines to be read</span>
<span class="sd">    usecols : int-array, optional</span>
<span class="sd">        Columns to be read from the file (zero indexed).</span>
<span class="sd">    skiprows : int, optional</span>
<span class="sd">        The number of leading rows which will be skipped.</span>
<span class="sd">    dtype : data-type, optional</span>
<span class="sd">        Data-type of the resulting array. Default: float.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    array : ndarray</span>
<span class="sd">        Data read from the text file.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># pandas does not support array of single char</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">comment</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># force pandas to load in stated order without sorting</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;usecols&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)[</span><span class="n">idx</span><span class="p">]</span>

        <span class="n">array</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
            <span class="n">file_name</span><span class="p">,</span>
            <span class="n">sep</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span>
            <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
            <span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span>
            <span class="n">usecols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">values</span>

        <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="c1"># swap columns back to ensure correct order</span>
        <span class="k">elif</span> <span class="n">cols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">swapcols</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)))</span>

        <span class="k">return</span> <span class="n">array</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span>
        <span class="n">file_name</span><span class="p">,</span>
        <span class="n">comments</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
        <span class="n">max_rows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msmhelper.savetxt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">savetxt</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.5f</span><span class="s1">&#39;</span><span class="p">)</span></code>

<a href="#msmhelper.savetxt" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

      <p>Save nxm array of floats to a text file.</p>
<p>It uses numpys savetxt method and extends the header with information
of execution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>file_name</code></b>
              (<code>string</code>)
          –
          <div class="doc-md-description">
            <p>File name to store data.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>array</code></b>
              (<code>ndarray</code>)
          –
          <div class="doc-md-description">
            <p>Data to be stored.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>header</code></b>
              (<code>str</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Comment written into the header of the output file.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>fmt</code></b>
              (<code>str or sequence of strs</code>, default:
                  <code>&#39;%.5f&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>See <a class="autorefs autorefs-external" href="https://numpy.org/doc/stable/reference/generated/numpy.savetxt.html#numpy.savetxt">numpy.savetxt</a>.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>src/msmhelper/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">savetxt</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.5f</span><span class="s1">&#39;</span><span class="p">):</span>  <span class="c1"># noqa: WPS323</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save nxm array of floats to a text file.</span>

<span class="sd">    It uses numpys savetxt method and extends the header with information</span>
<span class="sd">    of execution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file_name : string</span>
<span class="sd">        File name to store data.</span>
<span class="sd">    array : ndarray</span>
<span class="sd">        Data to be stored.</span>
<span class="sd">    header : str, optional</span>
<span class="sd">        Comment written into the header of the output file.</span>
<span class="sd">    fmt : str or sequence of strs, optional</span>
<span class="sd">        See [numpy.savetxt][].</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># prepare header comments</span>
    <span class="n">RUI</span> <span class="o">=</span> <span class="n">_get_runtime_user_information</span><span class="p">()</span>

    <span class="n">header_comment</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s1">&#39;This file was generated by </span><span class="si">{script_dir}</span><span class="s1">/</span><span class="si">{script_name}</span><span class="s1">:</span><span class="se">\n</span><span class="si">{args}</span><span class="s1">&#39;</span> <span class="o">+</span>
        <span class="s1">&#39;</span><span class="se">\n\n</span><span class="si">{date}</span><span class="s1">, </span><span class="si">{user}</span><span class="s1">@</span><span class="si">{pc}</span><span class="s1">&#39;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">RUI</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">header</span><span class="p">:</span>  <span class="c1"># print column title if given</span>
        <span class="n">header_comment</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>

    <span class="c1"># save file</span>
    <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">header_comment</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msmhelper.opentxt_limits" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">opentxt_limits</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">limits_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#msmhelper.opentxt_limits" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

      <p>Load file and split according to limit file.</p>
<p>If limits_file is not provided it will return <code>[traj]</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>file_name</code></b>
              (<code>string</code>)
          –
          <div class="doc-md-description">
            <p>Name of file to be opened.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>limits_file</code></b>
              (<code>str</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>File name of limit file. Should be single column ascii file.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>See parameters defined in <a class="autorefs autorefs-internal" href="io/#msmhelper.io.opentxt">opentxt</a></p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>traj</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Return array of subtrajectories.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>src/msmhelper/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">opentxt_limits</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">limits_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load file and split according to limit file.</span>

<span class="sd">    If limits_file is not provided it will return `[traj]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file_name : string</span>
<span class="sd">        Name of file to be opened.</span>
<span class="sd">    limits_file : str, optional</span>
<span class="sd">        File name of limit file. Should be single column ascii file.</span>
<span class="sd">    **kwargs</span>
<span class="sd">        See parameters defined in [opentxt][msmhelper.io.opentxt]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    traj : ndarray</span>
<span class="sd">        Return array of subtrajectories.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># open trajectory</span>
    <span class="n">traj</span> <span class="o">=</span> <span class="n">opentxt</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># open limits</span>
    <span class="n">limits</span> <span class="o">=</span> <span class="n">open_limits</span><span class="p">(</span><span class="n">limits_file</span><span class="o">=</span><span class="n">limits_file</span><span class="p">,</span> <span class="n">data_length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">traj</span><span class="p">))</span>

    <span class="c1"># split trajectory</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">limits</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msmhelper.openmicrostates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">openmicrostates</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">limits_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#msmhelper.openmicrostates" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

      <p>Load 1d file and split according to limit file.</p>
<p>Both, the limit file and the trajectory file needs to be a single column
file. If limits_file is not provided it will return [traj]. The trajectory
will of dtype np.int16, so the states needs to be smaller than 32767.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>file_name</code></b>
              (<code>string</code>)
          –
          <div class="doc-md-description">
            <p>Name of file to be opened.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>limits_file</code></b>
              (<code>str</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>File name of limit file. Should be single column ascii file.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>See parameters defined in <a class="autorefs autorefs-internal" href="io/#msmhelper.io.opentxt">opentxt</a></p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>traj</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Return array of subtrajectories.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>src/msmhelper/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">openmicrostates</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">limits_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load 1d file and split according to limit file.</span>

<span class="sd">    Both, the limit file and the trajectory file needs to be a single column</span>
<span class="sd">    file. If limits_file is not provided it will return [traj]. The trajectory</span>
<span class="sd">    will of dtype np.int16, so the states needs to be smaller than 32767.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file_name : string</span>
<span class="sd">        Name of file to be opened.</span>
<span class="sd">    limits_file : str, optional</span>
<span class="sd">        File name of limit file. Should be single column ascii file.</span>
<span class="sd">    **kwargs</span>
<span class="sd">        See parameters defined in [opentxt][msmhelper.io.opentxt]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    traj : ndarray</span>
<span class="sd">        Return array of subtrajectories.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># open trajectory</span>
    <span class="k">if</span> <span class="s1">&#39;dtype&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;dtype should be integer&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span>

    <span class="c1"># load split trajectory</span>
    <span class="n">traj</span> <span class="o">=</span> <span class="n">opentxt_limits</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">limits_file</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">FileError</span><span class="p">(</span><span class="s1">&#39;Microstate trjectory shoud be single column file.&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">traj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msmhelper.open_limits" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">open_limits</span><span class="p">(</span><span class="n">data_length</span><span class="p">,</span> <span class="n">limits_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#msmhelper.open_limits" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

      <p>Load and check limit file.</p>
<p>The limits give the length of each single trajectory. So e.g.
[5, 5, 5] for 3 equally-sized subtrajectories of length 5.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>data_length</code></b>
              (<code>int</code>)
          –
          <div class="doc-md-description">
            <p>Length of data read.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>limits_file</code></b>
              (<code>str</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>File name of limit file. Should be single column ascii file.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>limits</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Return cumsum of limits.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>src/msmhelper/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">open_limits</span><span class="p">(</span><span class="n">data_length</span><span class="p">,</span> <span class="n">limits_file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load and check limit file.</span>

<span class="sd">    The limits give the length of each single trajectory. So e.g.</span>
<span class="sd">    [5, 5, 5] for 3 equally-sized subtrajectories of length 5.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_length : int</span>
<span class="sd">        Length of data read.</span>
<span class="sd">    limits_file : str, optional</span>
<span class="sd">        File name of limit file. Should be single column ascii file.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    limits : ndarray</span>
<span class="sd">        Return cumsum of limits.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">limits_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">data_length</span><span class="p">])</span>  <span class="c1"># for single trajectory</span>

    <span class="c1"># open limits file</span>
    <span class="n">limits</span> <span class="o">=</span> <span class="n">opentxt</span><span class="p">(</span><span class="n">limits_file</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">limits</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">FileError</span><span class="p">(</span><span class="s1">&#39;Shoud be single column file.&#39;</span><span class="p">)</span>

    <span class="c1"># convert to cumulative sum</span>
    <span class="n">limits</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">limits</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data_length</span> <span class="o">!=</span> <span class="n">limits</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Limits are inconsistent to data.&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">limits</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msmhelper.rename_by_population" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename_by_population</span><span class="p">(</span><span class="n">trajs</span><span class="p">,</span> <span class="n">return_permutation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#msmhelper.rename_by_population" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

      <p>Rename states sorted by their population starting from 1.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>trajs</code></b>
              (<code>list or ndarray or list of ndarrays</code>)
          –
          <div class="doc-md-description">
            <p>State trajectory or list of state trajectories.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>return_permutation</code></b>
              (<code>bool</code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Return additionaly the permutation to achieve performed renaming.
Default is False.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>trajs</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Renamed data.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>permutation</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Permutation going from old to new state nameing. So the <code>i</code>th state
of the new naming corresponds to the old state <code>permutation[i-1]</code>.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>src/msmhelper/utils/_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rename_by_population</span><span class="p">(</span><span class="n">trajs</span><span class="p">,</span> <span class="n">return_permutation</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Rename states sorted by their population starting from 1.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    trajs : list or ndarray or list of ndarrays</span>
<span class="sd">        State trajectory or list of state trajectories.</span>
<span class="sd">    return_permutation : bool</span>
<span class="sd">        Return additionaly the permutation to achieve performed renaming.</span>
<span class="sd">        Default is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    trajs : ndarray</span>
<span class="sd">        Renamed data.</span>
<span class="sd">    permutation : ndarray</span>
<span class="sd">        Permutation going from old to new state nameing. So the `i`th state</span>
<span class="sd">        of the new naming corresponds to the old state `permutation[i-1]`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get unique states with population</span>
    <span class="n">states</span><span class="p">,</span> <span class="n">pop</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">trajs</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># get decreasing order</span>
    <span class="n">idx_sort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">pop</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">states</span> <span class="o">=</span> <span class="n">states</span><span class="p">[</span><span class="n">idx_sort</span><span class="p">]</span>

    <span class="c1"># rename states</span>
    <span class="n">trajs_renamed</span> <span class="o">=</span> <span class="n">shift_data</span><span class="p">(</span>
        <span class="n">trajs</span><span class="p">,</span>
        <span class="n">val_old</span><span class="o">=</span><span class="n">states</span><span class="p">,</span>
        <span class="n">val_new</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">states</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">return_permutation</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">trajs_renamed</span><span class="p">,</span> <span class="n">states</span>
    <span class="k">return</span> <span class="n">trajs_renamed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msmhelper.rename_by_index" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename_by_index</span><span class="p">(</span><span class="n">trajs</span><span class="p">,</span> <span class="n">return_permutation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#msmhelper.rename_by_index" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

      <p>Rename states sorted by their numerical values starting from 0.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>trajs</code></b>
              (<code>list or ndarray or list of ndarrays</code>)
          –
          <div class="doc-md-description">
            <p>State trajectory or list of state trajectories.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>return_permutation</code></b>
              (<code>bool</code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Return additionaly the permutation to achieve performed renaming.
Default is False.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>trajs</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Renamed data.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>permutation</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Permutation going from old to new state nameing. So the <code>i</code>th state
of the new naming corresponds to the old state <code>permutation[i-1]</code>.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>src/msmhelper/utils/_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rename_by_index</span><span class="p">(</span><span class="n">trajs</span><span class="p">,</span> <span class="n">return_permutation</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Rename states sorted by their numerical values starting from 0.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    trajs : list or ndarray or list of ndarrays</span>
<span class="sd">        State trajectory or list of state trajectories.</span>
<span class="sd">    return_permutation : bool</span>
<span class="sd">        Return additionaly the permutation to achieve performed renaming.</span>
<span class="sd">        Default is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    trajs : ndarray</span>
<span class="sd">        Renamed data.</span>
<span class="sd">    permutation : ndarray</span>
<span class="sd">        Permutation going from old to new state nameing. So the `i`th state</span>
<span class="sd">        of the new naming corresponds to the old state `permutation[i-1]`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get unique states</span>
    <span class="n">states</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">trajs</span><span class="p">)</span>

    <span class="c1"># rename states</span>
    <span class="n">trajs_renamed</span> <span class="o">=</span> <span class="n">shift_data</span><span class="p">(</span>
        <span class="n">trajs</span><span class="p">,</span>
        <span class="n">val_old</span><span class="o">=</span><span class="n">states</span><span class="p">,</span>
        <span class="n">val_new</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">states</span><span class="p">)),</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">return_permutation</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">trajs_renamed</span><span class="p">,</span> <span class="n">states</span>
    <span class="k">return</span> <span class="n">trajs_renamed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msmhelper.shift_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">shift_data</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">val_old</span><span class="p">,</span> <span class="n">val_new</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span></code>

<a href="#msmhelper.shift_data" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

      <p>Shift integer array (data) from old to new values.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The values of <code>val_old</code>, <code>val_new</code> and <code>data</code> needs to be integers.</p>
</div>
<p>The basic function is based on Ashwini_Chaudhary solution:
<a href="https://stackoverflow.com/a/29408060">https://stackoverflow.com/a/29408060</a></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>array</code></b>
              (<code>StateTraj or ndarray or list or list of ndarrays</code>)
          –
          <div class="doc-md-description">
            <p>1D data or a list of data.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>val_old</code></b>
              (<code>ndarray or list</code>)
          –
          <div class="doc-md-description">
            <p>Values in data which should be replaced. All values needs to be within
the range of <code>[data.min(), data.max()]</code></p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>val_new</code></b>
              (<code>ndarray or list</code>)
          –
          <div class="doc-md-description">
            <p>Values which will be used instead of old ones.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>dtype</code></b>
              (<code>data - type</code>, default:
                  <code><a class="autorefs autorefs-external" title="numpy.int64" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.int64">int64</a></code>
)
          –
          <div class="doc-md-description">
            <p>The desired data-type. Needs to be of type unsigned integer.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>array</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Shifted data in same shape as input.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>src/msmhelper/utils/_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">shift_data</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">val_old</span><span class="p">,</span> <span class="n">val_new</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shift integer array (data) from old to new values.</span>

<span class="sd">    !!! warning</span>
<span class="sd">        The values of `val_old`, `val_new` and `data` needs to be integers.</span>

<span class="sd">    The basic function is based on Ashwini_Chaudhary solution:</span>
<span class="sd">    https://stackoverflow.com/a/29408060</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    array : StateTraj or ndarray or list or list of ndarrays</span>
<span class="sd">        1D data or a list of data.</span>
<span class="sd">    val_old : ndarray or list</span>
<span class="sd">        Values in data which should be replaced. All values needs to be within</span>
<span class="sd">        the range of `[data.min(), data.max()]`</span>
<span class="sd">    val_new : ndarray or list</span>
<span class="sd">        Values which will be used instead of old ones.</span>
<span class="sd">    dtype : data-type, optional</span>
<span class="sd">        The desired data-type. Needs to be of type unsigned integer.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    array : ndarray</span>
<span class="sd">        Shifted data in same shape as input.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># check data-type</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;An unsigned integer type is needed.&#39;</span><span class="p">)</span>

    <span class="c1"># flatten data</span>
    <span class="n">array</span><span class="p">,</span> <span class="n">shape_kwargs</span> <span class="o">=</span> <span class="n">_flatten_data</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>

    <span class="c1"># offset data and val_old to allow negative values</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">array</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">val_new</span><span class="p">)])</span>

    <span class="c1"># convert to np.array</span>
    <span class="n">val_old</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">val_old</span><span class="p">)</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">val_new</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">val_new</span><span class="p">)</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>

    <span class="c1"># convert data and shift</span>
    <span class="n">array</span> <span class="o">=</span> <span class="p">(</span><span class="n">array</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>

    <span class="c1"># shift data</span>
    <span class="n">conv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">conv</span><span class="p">[</span><span class="n">val_old</span><span class="p">]</span> <span class="o">=</span> <span class="n">val_new</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">conv</span><span class="p">[</span><span class="n">array</span><span class="p">]</span>

    <span class="c1"># shift data back</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span> <span class="o">+</span> <span class="n">offset</span>

    <span class="c1"># reshape and return</span>
    <span class="k">return</span> <span class="n">_unflatten_data</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">shape_kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msmhelper.unique" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unique</span><span class="p">(</span><span class="n">trajs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#msmhelper.unique" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

      <p>Apply numpy.unique to traj.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>trajs</code></b>
              (<code>list or ndarray or list of ndarrays</code>)
          –
          <div class="doc-md-description">
            <p>State trajectory or list of state trajectories.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Arguments of <a class="autorefs autorefs-external" href="https://numpy.org/doc/stable/reference/generated/numpy.unique.html#numpy.unique">numpy.unique</a></p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>unique</code></b> (              <code>ndarray</code>
)          –
          <div class="doc-md-description">
            <p>Array containing all states, see numpy for more details.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>src/msmhelper/utils/_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">unique</span><span class="p">(</span><span class="n">trajs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Apply numpy.unique to traj.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    trajs : list or ndarray or list of ndarrays</span>
<span class="sd">        State trajectory or list of state trajectories.</span>
<span class="sd">    **kwargs</span>
<span class="sd">        Arguments of [numpy.unique][]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    unique : ndarray</span>
<span class="sd">        Array containing all states, see numpy for more details.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># flatten data</span>
    <span class="n">trajs</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_flatten_data</span><span class="p">(</span><span class="n">trajs</span><span class="p">)</span>

    <span class="c1"># get unique states with population</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">trajs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2019-2023 Daniel Nagel
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.moldyn.uni-freiburg.de" target="_blank" rel="noopener" title="www.moldyn.uni-freiburg.de" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M352 256c0 22.2-1.2 43.6-3.3 64H163.3c-2.2-20.4-3.3-41.8-3.3-64s1.2-43.6 3.3-64h185.4c2.2 20.4 3.3 41.8 3.3 64zm28.8-64h123.1c5.3 20.5 8.1 41.9 8.1 64s-2.8 43.5-8.1 64H380.8c2.1-20.6 3.2-42 3.2-64s-1.1-43.4-3.2-64zm112.6-32H376.7c-10-63.9-29.8-117.4-55.3-151.6 78.3 20.7 142 77.5 171.9 151.6zm-149.1 0H167.7c6.1-36.4 15.5-68.6 27-94.7 10.5-23.6 22.2-40.7 33.5-51.5C239.4 3.2 248.7 0 256 0s16.6 3.2 27.8 13.8c11.3 10.8 23 27.9 33.5 51.5 11.6 26 20.9 58.2 27 94.7zm-209 0H18.6c30-74.1 93.6-130.9 172-151.6-25.5 34.2-45.3 87.7-55.3 151.6zM8.1 192h123.1c-2.1 20.6-3.2 42-3.2 64s1.1 43.4 3.2 64H8.1C2.8 299.5 0 278.1 0 256s2.8-43.5 8.1-64zm186.6 254.6c-11.6-26-20.9-58.2-27-94.6h176.6c-6.1 36.4-15.5 68.6-27 94.6-10.5 23.6-22.2 40.7-33.5 51.5-11.2 10.7-20.5 13.9-27.8 13.9s-16.6-3.2-27.8-13.8c-11.3-10.8-23-27.9-33.5-51.5zM135.3 352c10 63.9 29.8 117.4 55.3 151.6-78.4-20.7-142-77.5-172-151.6h116.7zm358.1 0c-30 74.1-93.6 130.9-171.9 151.6 25.5-34.2 45.2-87.7 55.3-151.6h116.6z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/moldyn" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/MolDynFR" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.annotate", "navigation.tabs", "navigation.top"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>